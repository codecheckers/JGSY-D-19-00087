# JGSY-D-19-00087
Code checking materials for JGSY submission

`bivand_jgs_si1_rev2.R` article code, modified to output figures to graphics device rather than to file, lines 28-51 modified from de Vries (2014) https://blog.revolutionanalytics.com/2014/12/finding-clusters-of-cran-packages-using-igraph.html.

```
> sessionInfo()
R version 4.0.2 (2020-06-22)
Platform: x86_64-pc-linux-gnu (64-bit)
Running under: Fedora 32 (Workstation Edition)

Matrix products: default
BLAS:   /home/rsb/topics/R/R402-share/lib64/R/lib/libRblas.so
LAPACK: /home/rsb/topics/R/R402-share/lib64/R/lib/libRlapack.so

locale:
 [1] LC_CTYPE=en_GB.UTF-8       LC_NUMERIC=C              
 [3] LC_TIME=en_GB.UTF-8        LC_COLLATE=en_GB.UTF-8    
 [5] LC_MONETARY=en_GB.UTF-8    LC_MESSAGES=en_GB.UTF-8   
 [7] LC_PAPER=en_GB.UTF-8       LC_NAME=C                 
 [9] LC_ADDRESS=C               LC_TELEPHONE=C            
[11] LC_MEASUREMENT=en_GB.UTF-8 LC_IDENTIFICATION=C       

attached base packages:
[1] grid      stats     graphics  grDevices utils     datasets  methods  
[8] base     

other attached packages:
 [1] rgdal_1.5-17       sp_1.4-4           mapview_2.9.1      xtable_1.8-4
 [5] ggplot2_3.3.2      tmap_3.1           cartography_2.4.1  classInt_0.4-3  
 [9] stars_0.4-3        abind_1.4-5        sf_0.9-6           wordcloud_2.6   
[13] RColorBrewer_1.1-2 magrittr_1.5       igraph_1.2.5       miniCRAN_0.2.13   

loaded via a namespace (and not attached):
 [1] httr_1.4.2              jsonlite_1.7.0          viridisLite_0.3.0      
 [4] assertthat_0.2.1        stats4_4.0.2            yaml_2.2.1             
 [7] gdtools_0.2.2           pillar_1.4.6            lattice_0.20-41        
[10] glue_1.4.1              uuid_0.1-4              digest_0.6.25          
[13] leaflet.providers_1.9.0 colorspace_1.4-1        htmltools_0.5.0        
[16] XML_3.99-0.5            pkgconfig_2.0.3         raster_3.3-13          
[19] s2_1.0.2                purrr_0.3.4             scales_1.1.1           
[22] webshot_0.5.2           brew_1.0-6              svglite_1.2.3.2        
[25] satellite_1.0.2         tibble_3.0.3            rcartocolor_2.0.0      
[28] generics_0.0.2          farver_2.0.3            ellipsis_0.3.1         
[31] withr_2.2.0             leafsync_0.1.0          cli_2.0.2              
[34] crayon_1.3.4            fansi_0.4.1             lwgeom_0.2-5           
[37] class_7.3-17            tools_4.0.2             lifecycle_0.2.0        
[40] munsell_0.5.0           compiler_4.0.2          e1071_1.7-3            
[43] systemfonts_0.2.3       gridGraphics_0.5-0      rlang_0.4.7            
[46] units_0.6-7             tmaptools_3.1           leafpop_0.0.5          
[49] dichromat_2.0-0         htmlwidgets_1.5.1       crosstalk_1.1.0.1      
[52] leafem_0.1.3            base64enc_0.1-3         labeling_0.3           
[55] wk_0.3.2                gtable_0.3.0            codetools_0.2-16       
[58] DBI_1.1.0               R6_2.4.1                gridExtra_2.3          
[61] dplyr_1.0.2             rgeos_0.5-3             utf8_1.1.4             
[64] KernSmooth_2.23-17      parallel_4.0.2          Rcpp_1.0.5             
[67] vctrs_0.3.2             png_0.1-7               leaflet_2.0.3          
[70] tidyselect_1.1.0       
> sf::sf_extSoftVersion()
          GEOS           GDAL         proj.4 GDAL_with_GEOS     USE_PROJ_H 
       "3.8.1"        "3.1.2"        "7.1.1"         "true"         "true" 
> rgdal::rgdal_extSoftVersion()
          GDAL GDAL_with_GEOS           PROJ             sp 
       "3.1.2"         "TRUE"        "7.1.1"        "1.4-4" 
```

In this test run:
`sp` current status of https://github.com/rsbivand/sp as of 18 August 2020
`sf` current status of https://github.com/r-spatial/sf as of 27 August 2020
`rgdal` revision 1056 of https://r-forge.r-project.org/R/?group_id=884

Chunks 75-75 require PROJ >= 7 (with PROJ 6, gives same result as Helmert tramsformation). Script also runs OK with R 4.0.2 on Windows with CRAN versions of all packages. It is conceivable that the `wordcloud` output in Figure 1 should also use set.seed(), which was not included in the article but is added here - the placing, but not the relative sizes of the words may be affected.

Output: 

figure1.pdf
figure2.pdf
figure3.pdf
figure4a.pdf
figure4b.pdf
figure5.pdf
figure6.pdf
figure7.pdf

output.Rout generated by running `source("bivand_jgs_si1_rev2.R", echo=TRUE)` using `sink()` as specified in script. Aggregated acceptable warnings:

```
Warning messages:
1: In clean_columns(as.data.frame(obj), factorsAsCharacter) :
  Dropping column(s) c of class(es) list
2: st_crs<- : replacing crs does not reproject data; use st_transform for that 
3: In showSRID(uprojargs, format = "PROJ", multiline = "NO") :
  Discarded datum Unknown based on Airy 1830 ellipsoid in CRS definition
4: In showSRID(uprojargs, format = "PROJ", multiline = "NO") :
  Discarded datum Unknown based on Airy 1830 ellipsoid in CRS definition
```

Data files:

`olinda.gpkg` GPKG file of data as described in article, used for mapping examples,

`pdb_200820.rds` Frozen status of CRAN and BioConductor repositories 20 August 2020; chunk 13, line 14 ff. in `bivand_jgs_si1_rev2.R` may be run manually to re-generate for current status.

